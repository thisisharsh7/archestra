archestra:
  replicaCount: 4

  service:
    annotations:
      # GKE BackendConfig for custom health checks
      # Maps backend port (9000) and frontend port (3000) to their respective BackendConfigs
      # These BackendConfigs are defined in archestra-ai/infra repo (gke/ingress.tf)
      cloud.google.com/backend-config: '{"ports": {"9000":"archestra-platform-backend-config", "3000":"archestra-platform-frontend-config"}}'

  ingress:
    enabled: true
    annotations:
      # GKE Ingress Controller configuration
      kubernetes.io/ingress.class: "gce"
      kubernetes.io/ingress.global-static-ip-name: "archestra-staging-ip"
      ingress.gcp.cloud.google.com/load-balancer-type: "External"
      networking.gke.io/managed-certificates: "archestra-platform-staging-ssl"
      ingress.gcp.cloud.google.com/ssl-redirect: "true"

    hosts:
      - host: frontend.archestra.dev
        paths:
          - path: /
            port: 3000
            pathType: Prefix
      - host: backend.archestra.dev
        paths:
          # Block public access to metrics endpoint
          - path: /metrics
            port: 1
            pathType: Exact
          - path: /
            port: 9000
            pathType: Prefix
